# -*- coding: utf-8 -*-
'''
Created on 26 ene. 2019

@author: mateosg, reinaqu
'''
from zika import *

################################################################
#  Tests
################################################################  
    
def test_lee_fichero(datos):
    print(len(datos))
    print(datos[:3])
    
def test_num_casos_entre(datos):
    fecha_inicial = date(2015,1,1)
    fecha_final = date(2015,12,1)
    res = num_casos_entre(datos, fecha_inicial, fecha_final)
    print(res)
    
def test_casos_zika_territorio_USA(datos):
    res = casos_zika_territorio_USA(datos)
    print(res[:100])

def test_filtra_por_estado(datos):
    res = filtra_por_estado(datos, 2016)
    print(res[:5])

def test_anyo_mas_casos(datos):
    res = anyo_mas_casos(datos)
    print(res)

def test_porcentaje_por_descrip(datos):
    res = porcentaje_por_descrip(datos)
    print(res)
   
def test_dibuja_casos_zika_por_pais(datos):  
    pass
       
################################################################
#  Programa principal
################################################################
if __name__ == '__main__':
    datos=lee_fichero('../data/zika.csv');
    print('EJERCICIO 1:')
    #La salida esperada es:
    #Número total de registros: 37056
    #Mostrando los tres primeros registros leídos: [ZikaReport(date=datetime.date(2016, 7, 2), location='Brazil-Pernambuco', location_type='state', data_field='microcephaly_not', data_field_code='BR0003', value=1173, unit='cases'), ZikaReport(date=datetime.date(2016, 7, 2), location='Brazil-Bahia', location_type='state', data_field='microcephaly_under_investigation', data_field_code='BR0001', value=659, unit='cases'), ZikaReport(date=datetime.date(2016, 7, 2), location='Brazil-Pernambuco', location_type='state', data_field='microcephaly_under_investigation', data_field_code='BR0001', value=489, unit='cases')] 
    test_lee_fichero(datos)
    
    print('EJERCICIO 2:')
    #La salida esperada es:
    #Número de casos ocurridos entre 2015-01-01 y 2015-12-01: 1595
    test_num_casos_entre(datos)
      
    print('EJERCICIO 3:')
    #La salida esperada es:
    #Los casos del virus zika declarados en el terriotorio USA son
    #[('United_States-Puerto_Rico', 1970), ('United_States-American_Samoa', 29), ('United_States-US_Virgin_Islands', 21), ('United_States-Puerto_Rico', 5), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 326), ('United_States_Virgin_Islands', 252), ('United_States_Virgin_Islands', 43), ('United_States_Virgin_Islands', 29), ('United_States_Virgin_Islands', 22), ('United_States_Virgin_Islands', 19), ('United_States_Virgin_Islands', 18), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 13), ('United_States_Virgin_Islands', 13), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States-Puerto_Rico', 1804), ('United_States-American_Samoa', 29), ('United_States-Pennsylvania', 24), ('United_States-US_Virgin_Islands', 21), ('United_States-Puerto_Rico', 5), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 302), ('United_States_Virgin_Islands', 224), ('United_States_Virgin_Islands', 49), ('United_States_Virgin_Islands', 26), ('United_States_Virgin_Islands', 18), ('United_States_Virgin_Islands', 18), ('United_States_Virgin_Islands', 17), ('United_States_Virgin_Islands', 13), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States-Puerto_Rico', 1386), ('United_States-American_Samoa', 29), ('United_States-Pennsylvania', 23), ('United_States-US_Virgin_Islands', 21), ('United_States-Puerto_Rico', 3), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 302), ('United_States_Virgin_Islands', 224), ('United_States_Virgin_Islands', 49), ('United_States_Virgin_Islands', 26), ('United_States_Virgin_Islands', 18), ('United_States_Virgin_Islands', 18), ('United_States_Virgin_Islands', 17), ('United_States_Virgin_Islands', 13), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States-Puerto_Rico', 1259), ('United_States-American_Samoa', 21), ('United_States-US_Virgin_Islands', 21), ('United_States-Puerto_Rico', 3), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 276), ('United_States_Virgin_Islands', 204), ('United_States_Virgin_Islands', 45), ('United_States_Virgin_Islands', 24), ('United_States_Virgin_Islands', 17), ('United_States_Virgin_Islands', 17), ('United_States_Virgin_Islands', 17), ('United_States_Virgin_Islands', 13), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 253), ('United_States_Virgin_Islands', 200), ('United_States_Virgin_Islands', 26), ('United_States_Virgin_Islands', 24), ('United_States-US_Virgin_Islands', 21), ('United_States-American_Samoa', 17), ('United_States_Virgin_Islands', 17), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States-US_Virgin_Islands', 1), ('United_States-Puerto_Rico', 903), ('United_States-American_Samoa', 17), ('United_States-US_Virgin_Islands', 15), ('United_States-Puerto_Rico', 3), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 228), ('United_States_Virgin_Islands', 183), ('United_States_Virgin_Islands', 21), ('United_States_Virgin_Islands', 21), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 228), ('United_States_Virgin_Islands', 176), ('United_States_Virgin_Islands', 28), ('United_States_Virgin_Islands', 21), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States-Puerto_Rico', 669), ('United_States-US_Virgin_Islands', 15), ('United_States-American_Samoa', 14), ('United_States-Puerto_Rico', 2), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 212), ('United_States_Virgin_Islands', 152), ('United_States_Virgin_Islands', 36), ('United_States_Virgin_Islands', 21), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States-Puerto_Rico', 629), ('United_States-US_Virgin_Islands', 15), ('United_States-American_Samoa', 14), ('United_States-Puerto_Rico', 2), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 210), ('United_States_Virgin_Islands', 123), ('United_States_Virgin_Islands', 63), ('United_States_Virgin_Islands', 21), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States-Puerto_Rico', 570), ('United_States-American_Samoa', 14), ('United_States-US_Virgin_Islands', 12), ('United_States-Puerto_Rico', 2), ('United_States-US_Virgin_Islands', 1), ('United_States-Puerto_Rico', 474), ('United_States-American_Samoa', 14), ('United_States-US_Virgin_Islands', 12), ('United_States-Puerto_Rico', 2), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 203), ('United_States_Virgin_Islands', 192), ('United_States_Virgin_Islands', 107), ('United_States_Virgin_Islands', 103), ('United_States_Virgin_Islands', 83), ('United_States_Virgin_Islands', 68), ('United_States_Virgin_Islands', 16), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States-Puerto_Rico', 445), ('United_States-American_Samoa', 14), ('United_States-US_Virgin_Islands', 12), ('United_States-Puerto_Rico', 3), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 177), ('United_States_Virgin_Islands', 107), ('United_States_Virgin_Islands', 54), ('United_States_Virgin_Islands', 14), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States-Puerto_Rico', 325), ('United_States-American_Samoa', 14), ('United_States-US_Virgin_Islands', 12), ('United_States-Puerto_Rico', 2), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 148), ('United_States_Virgin_Islands', 93), ('United_States_Virgin_Islands', 40), ('United_States_Virgin_Islands', 13), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States-Puerto_Rico', 325), ('United_States-American_Samoa', 14), ('United_States-US_Virgin_Islands', 10), ('United_States-Puerto_Rico', 2), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 77), ('United_States_Virgin_Islands', 62), ('United_States_Virgin_Islands', 59), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States-Puerto_Rico', 258), ('United_States-American_Samoa', 14), ('United_States-US_Virgin_Islands', 10), ('United_States-Puerto_Rico', 3), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 94), ('United_States_Virgin_Islands', 79), ('United_States_Virgin_Islands', 44), ('United_States_Virgin_Islands', 12), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States-Puerto_Rico', 259), ('United_States-American_Samoa', 14), ('United_States-US_Virgin_Islands', 10), ('United_States-Puerto_Rico', 2), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 94), ('United_States_Virgin_Islands', 80), ('United_States_Virgin_Islands', 31), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 10), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 9), ('United_States_Virgin_Islands', 8), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States-Puerto_Rico', 159), ('United_States-American_Samoa', 13), ('United_States-Puerto_Rico', 1), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 75), ('United_States_Virgin_Islands', 65), ('United_States_Virgin_Islands', 30), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 7), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 72), ('United_States_Virgin_Islands', 63), ('United_States_Virgin_Islands', 22), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 6), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 5), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States-Puerto_Rico', 34), ('United_States-American_Samoa', 4), ('United_States-Puerto_Rico', 1), ('United_States-US_Virgin_Islands', 1), ('United_States_Virgin_Islands', 63), ('United_States_Virgin_Islands', 56), ('United_States_Virgin_Islands', 15), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 4), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 3), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 2), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 61), ('United_States_Virgin_Islands', 39), ('United_States_Virgin_Islands', 11), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1), ('United_States_Virgin_Islands', 1)]
    test_casos_zika_territorio_USA(datos)
         
    print('EJERCICIO 4:')
    #La salida esperada es:
    #Mostrando los cinco primeros estados en los que se dieron casos del virus zika en 2016
    #[(datetime.date(2016, 1, 2), 'Mexico-Chiapas'), (datetime.date(2016, 1, 2), 'Mexico-Jalisco'), (datetime.date(2016, 1, 2), 'Mexico-Nuevo_Leon'), (datetime.date(2016, 1, 16), 'Mexico-Chiapas'), (datetime.date(2016, 1, 16), 'United_States-Florida')] 
    test_filtra_por_estado(datos)
     
    print('EJERCICIO 5:')
    #La salida esperada es:
    #Mostrando el año con más casos de virus zika:
    #4987004 casos detectados en el año 2016
    test_anyo_mas_casos(datos)

    print('EJERCICIO 6:')
    #Las primeras líneas de la salida esperada son:
    #Mostrando el porcentaje de municipios agrupados por descripción
    #microcephaly_not -> 1.3843911917098446
    #microcephaly_under_investigation -> 1.481541450777202
    #microcephaly_confirmed -> 1.2710492227979275
    #municipality_microcephaly_suspected -> 1.4113773747841105
    #municipality_microcephaly -> 1.2953367875647668
    #microcephaly_fatal_under_investigation -> 0.8500647668393783
    #microcephaly_fatal_confirmed -> 0.6260794473229706
    #microcephaly_fatal_not -> 0.7124352331606217
    #zika_reported_local -> 0.13493091537132987
    #total_zika_confirmed_cumulative -> 0.39939550949913644
    #total_zika_confirmed_ages_20-49yrs_F -> 0.03238341968911917
    test_porcentaje_por_descrip(datos)
    
    print('EJERCICIO 7:')
    test_dibuja_casos_zika_por_pais(datos)